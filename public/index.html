<!DOCTYPE html> 
<html>
<head>
	<meta charset="utf-8">
	<title>cdbo</title>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
	<script type="text/javascript">
		angular.module('myApp', [])
		.controller('StoreController', function($scope, $http) {
			var storeCtlr = this;
			storeCtlr.address = "";
			storeCtlr.stores = [];

			this.getStores = function() {
				$http.get('https://codybo.herokuapp.com/lcbo-nearby?geo=' + encodeURIComponent(storeCtlr.address))
				.then(
					function(data) {
						storeCtlr.stores = data;
				}); // then
			};
		}); // StoreController
	</script>

</head>
<body ng-app="myApp">
	<div ng-controller="StoreController as c">
		<input type="text" ng-model="c.address">
		<input type="submit" ng-click="c.getStores()" value="Submit">
		<ul>
			<li ng-repeat="store in c.stores">
				<span>{{store.name}}</span>
				<span>{{store.address_line_1}}</span>
				<span>{{store.city}}</span>
				<span>{{store.postal_code}}</span>
			</li>
		</ul>

    </div>

<!--

    <div>
		<p>10 stores nearest to your current position</p>
		<img src="loading.gif" id="spin">
		<div id="url" style="display: none;"> </div>
		<div id="geo"> </div>   
		</script> 
		<script >     
			navigator.geolocation.getCurrentPosition(function(position) {
  				url = "https://codybo.herokuapp.com/lcbo-nearby?lat=" + position.coords.latitude + "&lon=" + position.coords.longitude;
  				document.getElementById("url").innerText = url;
  				$.getJSON(url).then(function(data) {
  					data.forEach(function(store) {
  						var newP = document.createElement("p");
  						newP.innerText = store.tags;
  						document.getElementById("geo").appendChild(newP);
  						document.getElementById("spin").style.display = "none";
  					})
            		
        		});	
			});
		</script>    
    </div>


-->
	</body>
</html>